<div class="breadcrumbs">
  <div class="left">
    <span>
      <i class="pi pi-home"></i>
      {{'menu.data.bank' | translate}}
    </span>

    <span>
      <i class="pi pi-angle-right"></i>
      <span>
        {{'menu.data.topic.store' | translate}}
      </span>
    </span>
    <span>
      <i class="pi pi-angle-right"></i> 
      <span>{{'menu.my.permission.application' | translate}}</span>
    </span>
  </div>

  <div class="right"></div>
</div>
<div *ngIf="currPanel === 'list'" class="datatable-box">
  <div class="sys-search-form">
    <div class="form-item">
      <label id="name">{{'field.topic.name'| translate}}</label>
      <input type="text" class="input-text" pInputText [placeholder]="'input.please' | translate"
        [(ngModel)]="queryParams.topicName" />
    </div>
    <div class="form-item">
      <label id="source">{{'status'| translate}}</label>
      <p-dropdown [emptyMessage]="'no.results.found' | translate" class="input-text" [options]="statusList"
        [placeholder]="'input.select.please' | translate" [(ngModel)]="queryParams.status" optionLabel="name"
        optionValue="id"></p-dropdown>
    </div>

    <div class="form-item btn">
      <div onkeydown="" class="da-button search" (click)="onQuery()">{{'operate.search' | translate}}</div>
      <div onkeydown="" class="da-button" (click)="onReset()">{{'operate.reset' | translate}}</div>
    </div>
  </div>
  <div class="xd-grey-box" style="height: calc(100% - 50px)">
    <div class="tableBox" style="height: calc(100% - 40px)">
      <p-table styleClass="sys-table" [loading]="loading" [scrollable]="true" scrollHeight="flex" [value]="pageData"
        [resizableColumns]="true" columnResizeMode="expand" dataKey="code" [tableStyle]="{ 'min-width': '100%' }">
        <ng-template pTemplate="header">
          <tr>
            <th class="xd-theader-white" pResizableColumn>
              {{'field.topic.name' | translate}}
            </th>
            <th class="xd-theader-white" pResizableColumn>
              {{'field.status' | translate}}
            </th>
            <th class="xd-theader-white" pResizableColumn>
              {{'field.version' | translate}}
            </th>
            <th class="xd-theader-white" pResizableColumn>
              {{'label.author' | translate}}
            </th>
            <th class="xd-theader-white" pResizableColumn>
              {{'info.audit.content' | translate}}
            </th>
            <!-- <th class="xd-theader-white" pResizableColumn>
              {{'field.description' | translate}}
            </th> -->
            <!-- <th class="xd-theader-white" pFrozenColumn alignFrozen="right">
              {{'label.operate' | translate}}
            </th> -->
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
          <tr>
            <td class="xd-tbody text-overflow inline-block" [title]="item.name">
              {{ item.name }}
            </td>
            <td class="xd-tbody text-overflow inline-block">
              <p-tag *ngIf="item.status === 'New'" severity="primary"
                [value]="statusObj[item.status] | translate"></p-tag>
              <p-tag *ngIf="item.status === 'Approved'" severity="success"
                [value]="statusObj[item.status] | translate"></p-tag>
              <p-tag *ngIf="item.status === 'Rejected'" severity="danger"
                [value]="statusObj[item.status] | translate"></p-tag>
            </td>
            <td class="xd-tbody text-overflow inline-block">
              {{ item.version }}
            </td>
            <td class="xd-tbody text-overflow inline-block">
              {{ item.author }}
            </td>
            <td class="xd-tbody text-overflow inline-block" [title]="item.description">
              {{ item.remark }}
            </td>
            <!-- <td class="xd-tbody text-overflow inline-block" [title]="item.description">
              {{ item.description }}
            </td> -->
            <!-- <td class="xd-tbody" pFrozenColumn alignFrozen="right">
              <div class="table-button-box">
                <div class="table-button" (click)="viewData(item)">
                  {{'detail' | translate}}
                </div>
              </div>
            </td> -->
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="4" class="no-data">{{'nodata' | translate}}</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <div style="width: 100%" [hidden]="!(total > 0)">
      <nz-pagination class="flex justify-content-center" [nzPageIndex]="queryParams.pageNum" [nzTotal]="total"
        nzShowSizeChanger [nzPageSize]="queryParams.pageSize" [nzShowTotal]="rangeTemplate"
        (nzPageIndexChange)="nzPageIndexChange($event)" (nzPageSizeChange)="nzPageSizeChange($event)"></nz-pagination>
      <ng-template #rangeTemplate let-range="range" let-total>
        {{ queryParams.pageNum + (queryParams.pageNum - 1) * queryParams.pageSize }}-{{
        queryParams.pageNum * queryParams.pageSize }} {{'label.pagination.of' | translate}} {{ total }}
      </ng-template>
    </div>
  </div>
</div>

<app-data-topic-store-detail [field]="currRow" *ngIf="currPanel === 'detail'"></app-data-topic-store-detail>

<p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>
<p-toast></p-toast>